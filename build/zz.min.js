define(function(){"use strict";var a={getRandomColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)}};return a}),define(function(){var a={kindof:function(b,c){var d=c||.1;if(isNaN(b)&&0==b.indexOf("#")){var e=[1,3,5].map(function(a){return parseInt(b.slice(a,a+2),16)});return"#"+e.map(function(b){return a.convertToHex(kindof(b,d))})}return Math.random()*b*d+b-b*c/2},closeEnough:function(a,b){return a>b-1?b:a},convertToHex:function(b){var c=a.closeEnough(b,255).toString(16).substring(0,2);return c.length<2?"0"+c:c}};return a.kindof}),define(["jquery","curve"],function(){"use strict";var a,b,c=Math.PI/180;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var d={canvas:null,renderCallback:null,startTime:null,init:function(c){b=c,this.canvas=b,this.world.h=c.height,this.world.w=c.width,a=b.getContext("2d")},spriteEngine:{spriteImageSrc:null},run:function(a){this.renderCallback=a,this.startTime=(new Date).getTime(),this.animate(this.startTime)},definitions:{shapes:[]},world:{w:0,h:0,items:[],wind:{x:30,y:0},friction:{global:0},gravity:{x:0,y:4},adjustItemsToGravity:function(){var a=this;this.items.forEach(function(b){b.speedY+=.1,b.y=b.y+b.attachedForce.y+a.gravity.y*b.speedY*b.mass,b.x=b.x+b.attachedForce.x+a.gravity.x+1e3*b.speedX})}},isCollide:function(a,b){return!(a.y+a.h<b.y||a.y>b.y+b.h||a.x+a.w<b.x||a.x>b.x+b.w)},stickFigure:function(a,b,c,d,e,f,g,h,i){this.x=a,this.y=b,this.h=d,this.w=c,this.speedY=0,this.speedX=0,this.fillColor=e||"#000000",this.strokeColor=f||"#000000",this.path=g,this.pathType="square",this.mass=h||0,this.attachedForce=i||{x:0,y:0},this.original={},jQuery.extend(this.original,this),this.id=Math.random()},animate:function(c){a.clearRect(0,0,b.width,b.height);try{this.world.adjustItemsToGravity(),this.renderCallback(a)}catch(e){alert("No callback defined, or bad callback"),alert(e.message)}requestAnimFrame(function(){d.animate(c)})},calcBezierPoint:function(a,b,c,d,e){for(var f=[b,c,d,e],g=1-a,h=1;h<f.length;h++)for(var i=0;i<f.length-h;i++)f[i]={x:f[i].x*g+f[i+1].x*a,y:f[i].y*g+f[i+1].y*a};return f[0]},sprite:function(a,b,c,d,e,f){this.x=a,this.y=b;var g=new Image;g.src=null==spriteEngine.spriteImageSrc?new Error("Sprite image undefined"):spriteEngine.spriteImageSrc,this.charImage=g,this.w=c||22,this.h=d||28,this.spriteX=e||0,this.spriteY=f||0,this.original={},jQuery.extend(this.original,this),this.angle=0,this.moveDir=0},resetAllProps:function(a){for(var b in this)this.hasOwnProperty(b)&&"original"!=b&&a!=b&&(this[b]=this.original[b])},ctxDirty:!1,saveContext:function(){a.save(),this.ctxDirty=!0},restoreContext:function(){this.ctxDirty&&(a.restore(),this.ctxDirty=!1)}};return d.stickFigure.prototype.reset=d.resetAllProps,d.sprite.prototype.reset=d.resetAllProps,d.sprite.prototype.render=function(){0!=this.angle&&(saveContext(),doRestore=!0,a.translate(this.x+this.w/2,this.y+this.h/2),a.rotate(this.presentationAngle*c),a.translate(-1*(this.x+this.w/2),-1*(this.y+this.h/2))),a.drawImage(this.charImage,this.spriteX,this.spriteY,this.w,this.h,this.x,this.y,this.w,this.h),restoreContext()},d.stickFigure.prototype.render=function(b){var e=!1;if(0!=this.angle&&(d.saveContext(),e=!0,a.translate(this.x+this.w/2,this.y+this.h/2),a.rotate(this.angle*c),a.translate(-1*(this.x+this.w/2),-1*(this.y+this.h/2))),a.beginPath(),a.moveTo(this.path[0]+this.x,this.path[1]+this.y),"square"==this.pathType)for(var f=2;f<this.path.length;f+=2)a.lineTo(this.path[f]+this.x,this.path[f+1]+this.y);else{a.curve(this.path,.5,10,!1,this.x,this.y)}a.closePath(),a.lineWidth=1|this.lineWidth,a.strokeStyle=this.strokeColor,a.fillStyle=this.fillColor,a.stroke(),a.fill(),d.restoreContext(),"undefined"!=typeof b&&b(this)},d}),define(["jquery"],function(a){var b={debugItems:[],runOnce:!1,debug:function(b,c){var d="<div id='zzDebugDiv' style='position:absolute;z-index:1000;top:20px;left:820px;font-family:courier;color:black;'><ul></ul></div>";this.runOnce||(a("body").append(d),runOnce=!0);var e=!1;this.debugItems.forEach(function(a){a.id==b&&(a.message=c,e=!0)}),e||this.debugItems.push({id:b,message:c}),this.debugItems.forEach(function(a){d+="<li>DEBUG "+a.id+": "+a.message}),d+="</li>",a("#zzDebugDiv ul").html(d)}};return b}),define(function(a){var a=require("lib/zz"),b={boundEvents:[],bind:function(c,d,e){var f=d;"mouseover"==d&&(d="mousemove"),this.eventTypeExist(d)||a.canvas.addEventListener(d,function(c){var e={x:c.pageX-1,y:c.pageY-1,w:2,h:2},f=b.boundEvents.filter(function(a){return a.eventType==d});f.forEach(function(d){if(a.isCollide(d.item,e))"mouseover"==d.origType&&(d.item.mouseover=!0),d.callBack(c,d.item);else{var f=b.getBoundEvents("mouseout",d.item);f.length>0&&d.item.mouseover&&f[0].callBack(c,d.item)}})},!1),this.boundEvents.push({item:c,eventType:d,callBack:e,origType:f})},getBoundEvents:function(a,c){return b.boundEvents.filter(function(b){return b.eventType==a&&b.item.path==c.path&&b.item.x==c.x})},eventTypeExist:function(a){var b=!1;return this.boundEvents.forEach(function(c){c.eventType==a&&(b=!0)}),b}};return b}),define(function(){"use strict";return{shapeSize:function(a){var b=a.filter(function(a,b){return b%2==0}),c=a.filter(function(a,b){return b%2!=0}),d={w:Math.max.apply(null,b),h:Math.max.apply(null,c)},e={w:Math.min.apply(null,b),h:Math.min.apply(null,c)};return{w:d.w-e.w,h:d.h-e.h}}}}),CanvasRenderingContext2D.prototype.curve=function(a,b,c,d,e,f){"use strict";function g(a,d,e){for(var f=2;e>f;f+=2)for(var g=a[f],h=a[f+1],i=a[f+2],j=a[f+3],m=(i-a[f-2])*b,n=(j-a[f-1])*b,o=(a[f+4]-g)*b,p=(a[f+5]-h)*b,q=0;c>q;q++){var r=q<<2,s=d[r],t=d[r+1],u=d[r+2],v=d[r+3];l[k++]=s*g+t*i+u*m+v*o,l[k++]=s*h+t*j+u*n+v*p}}b="number"==typeof b?b:.5,c=c?c:25;var h,i,j=(a.length-2)*c+2+(d?2*c:0),k=0,l=new Float32Array(j),m=a.length,n=new Float32Array(4*(c+2)),o=4;for(h=a.slice(0),d?(h.unshift(a[m-1]),h.unshift(a[m-2]),h.push(a[0],a[1])):(h.unshift(a[1]),h.unshift(a[0]),h.push(a[m-2],a[m-1])),n[0]=1,i=1;c>i;i++){var p=i/c,q=p*p,r=q*p,s=2*r,t=3*q;n[o++]=s-t+1,n[o++]=t-s,n[o++]=r-2*q+p,n[o++]=r-q}for(n[++o]=1,g(h,n,m),d&&(h=[],h.push(a[m-4],a[m-3],a[m-2],a[m-1]),h.push(a[0],a[1],a[2],a[3]),g(h,n,4)),m=d?0:a.length-2,l[k++]=a[m],l[k]=a[m+1],i=0,m=l.length;m>i;i+=2)this.lineTo(l[i]+e,l[i+1]+f);return l};